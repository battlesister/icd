<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ranges of ICD codes • icd: Comorbidities and tools for ICD codes</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Ranges of ICD codes">
<meta property="og:description" content="icd">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">icd: Comorbidities and tools for ICD codes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.0.9.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jackwasey/icd/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Ranges of ICD codes</h1>
                        <h4 class="author">Jack O. Wasey</h4>
            
            <h4 class="date">2020-06-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jackwasey/icd/blob/master/vignettes/ranges.Rmd"><code>vignettes/ranges.Rmd</code></a></small>
      <div class="hidden name"><code>ranges.Rmd</code></div>

    </div>

    
    
<!--
Copyright (C) 2014 - 2020  Jack O. Wasey

This file is part of icd.

icd is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

icd is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with icd. If not, see <http:#www.gnu.org/licenses/>.
-->
<div id="ranges-of-icd-9-codes" class="section level1">
<h1 class="hasAnchor">
<a href="#ranges-of-icd-9-codes" class="anchor"></a>Ranges of ICD-9 codes</h1>
<p>These internal functions generate ranges of valid ICD-9 codes, without including parent codes when the range limit would subset the parent. These were primarily designed to accurately reflect definitions for comorbidity maps. For example, the published article defining Quan’s version of the Elixhauser comorbidities includes the following expression as part of the definition of the arrythmia comorbidity: <em>746.3 – 746.6</em>.</p>
<p>The functions can be used by running <code><a href="https://devtools.r-lib.org//reference/load_all.html">devtools::load_all()</a></code> from the icd source tree available from <a href="https://github.com/jackwasey/icd">github</a>, or by using the</p>
<p>Using icd, we can use this shortcut to expand decimal ICD-9 codes to all possible child codes:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="st">"746.3"</span> <span class="kw">%i9da%</span> <span class="st">"746.6"</span>
<span class="co"># equivalent to:</span>
<span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(<span class="st">"746.3"</span> <span class="kw">%i9da%</span> <span class="st">"746.6"</span>,
  <span class="kw pkg">icd</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/expand_range.html">expand_range</a></span>(<span class="st">"746.3"</span>, <span class="st">"746.6"</span>, <span class="kw">defined</span> <span class="kw">=</span> <span class="fl">FALSE</span>))</pre></body></html></div>
<p>This includes all possible codes, not just the ones that have been explicitly defined: this is important in correctly assigning new or slightly incorrect ICD codes in the right comorbidity). In contrast, the same expression using just defined codes gives:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="st">"746.3"</span> <span class="kw">%i9d%</span> <span class="st">"746.6"</span></pre></body></html></div>
<p>If a country adds more detail, e.g., a new code <code>746.60</code>, we want to capture this as an arrythmia comorbidity, even though the USA or WHO schemes do not include it. For this reason, icd expands out all the possible codes for each ICD-9 comorbidity in the included maps. (ICD-10 codes cannot be expanded this way in the maps due to the very large number of permutations, but the equivalent is done during the computation of comorbidities.)</p>
<div id="ranges-spanning-higher-level-codes" class="section level2">
<h2 class="hasAnchor">
<a href="#ranges-spanning-higher-level-codes" class="anchor"></a>Ranges spanning higher-level codes</h2>
<p>Another problem is whether to include broader parent codes when a range does not include all the children: e.g., <code>"100.99" %i9da% "101.01"</code> does not include <code>100</code> or <code>100.0</code>, both of which imply larger subsets than requested by the range command (i.e., every code from <code>100.00</code> to <code>100.99</code>). The shorter forms <code><a href="../reference/expand_range.html">%i9s%</a></code> and <code><a href="../reference/expand_range.html">%i9d%</a></code> return only <em>real</em> codes (i.e., listed in the CMS definitions as either three-digit codes or diagnoses), whereas <code><a href="../reference/expand_range.html">%i9sa%</a></code> and <code><a href="../reference/expand_range.html">%i9da%</a></code> return all possible syntactically valid ICD-9 codes:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># get all possible codes</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="st">"003"</span> <span class="kw">%i9sa%</span> <span class="st">"0033"</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fl">9</span>) <span class="co"># show first 9 of 111 values</span>
<span class="co"># just get the ones which correspond to diagnoses (keeping the 3-digit chapters)</span>
<span class="st">"494"</span> <span class="kw">%i9s%</span> <span class="st">"4941"</span>

<span class="st">"10099"</span> <span class="kw">%i9sa%</span> <span class="st">"10101"</span>
<span class="st">"V10"</span> <span class="kw">%i9da%</span> <span class="st">"V10.02"</span>
<span class="st">"E987"</span> <span class="kw">%i9da%</span> <span class="st">"E988.1"</span>

<span class="co"># can't range between different types:</span>
<span class="st">"V10"</span> <span class="kw">%i9s%</span> <span class="st">"E800"</span> <span class="co"># should throw an error</span></pre></body></html></div>
<p>This is used internally to interpret ranges of ICD-9 codes specified in the literature. Sometimes it is not clear exactly what an ICD-9 range presented in a paper means, but at least we can explicitly decide what should be included in our interpretation, and the ranges can be reused even when the underlying codes may be different, as codes are added and removed from time-to-time, and although the original papers would have been based on their ICD-9 ranges resolving to a specific set of codes, they are likely to be valid for new diagnoses in the given subgroups. Ultimately, this needs detailed attention, but the strategy in  is to give a good best guess, given these limitations.</p>
</div>
<div id="alternative-way-to-expand-ranges" class="section level2">
<h2 class="hasAnchor">
<a href="#alternative-way-to-expand-ranges" class="anchor"></a>Alternative way to expand ranges</h2>
<p>Another way of specifying ranges are to use function calls. These are exactly equivalent to the <code><a href="../reference/expand_range.html">%i9s%</a></code> and <code><a href="../reference/expand_range.html">%i9d%</a></code> range operators. This example shows the result when the user specifies a range which would include parents but not all their children:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="kw pkg">icd</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/expand_range.html">expand_range</a></span>(<span class="st">"4820"</span>, <span class="st">"4823"</span>) <span class="co"># default, equivalent to %i9s%</span>
<span class="co">#&gt; [1] "4820"  "4821"  "4822"  "4823"  "48230" "48231" "48232" "48239"</span>
<span class="kw pkg">icd</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/expand_range.html">expand_range</a></span>(<span class="st">"4820"</span>, <span class="st">"4823"</span>, <span class="kw">defined</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">#&gt;  [1] "4820"  "48200" "48201" "48202" "48203" "48204" "48205" "48206" "48207"</span>
<span class="co">#&gt; [10] "48208" "48209" "4821"  "48210" "48211" "48212" "48213" "48214" "48215"</span>
<span class="co">#&gt; [19] "48216" "48217" "48218" "48219" "4822"  "48220" "48221" "48222" "48223"</span>
<span class="co">#&gt; [28] "48224" "48225" "48226" "48227" "48228" "48229" "4823"  "48230" "48231"</span>
<span class="co">#&gt; [37] "48232" "48233" "48234" "48235" "48236" "48237" "48238" "48239"</span>
<span class="co"># see the first few differences (which are by definition not 'real' codes):</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(
  <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(<span class="kw pkg">icd</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/expand_range.html">expand_range</a></span>(<span class="st">"4820"</span>, <span class="st">"4823"</span>, <span class="kw">defined</span> <span class="kw">=</span> <span class="fl">FALSE</span>),
          <span class="kw pkg">icd</span><span class="kw ns">:::</span><span class="fu"><a href="../reference/expand_range.html">expand_range</a></span>(<span class="st">"4820"</span>, <span class="st">"4823"</span>)))
<span class="co">#&gt; [1] "48200" "48201" "48202" "48203" "48204" "48205"</span></pre></body></html></div>
</div>
<div id="finding-codes-in-hierarchy" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-codes-in-hierarchy" class="anchor"></a>Finding codes in hierarchy</h2>
<p>It is easy to find the children of a higher-level ICD-9 code:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../reference/children.html">children</a></span>(<span class="st">"391"</span>)
<span class="co">#&gt; [1] "391"  "3910" "3911" "3912" "3918" "3919"</span>
<span class="co"># mid-level code</span>
<span class="fu"><a href="../reference/children.html">children</a></span>(<span class="st">"0032"</span>)
<span class="co">#&gt; [1] "0032"  "00320" "00321" "00322" "00323" "00324" "00329"</span>
<span class="co"># leaf node has no children, so returns itself</span>
<span class="fu"><a href="../reference/children.html">children</a></span>(<span class="st">"00320"</span>)
<span class="co">#&gt; [1] "00320"</span>

<span class="co"># pneumococcal pneumonia is a three-digit ICD-9 code with no descendants</span>
<span class="fu"><a href="../reference/children.html">children</a></span>(<span class="st">"481"</span>)
<span class="co">#&gt; [1] "481"</span></pre></body></html></div>
<p>By adding <code>defined = TRUE</code>, all syntactically valid ICD-9 codes are returned, even if not defined by CMS as diagnoses. This is relevant because of minor coding errors, or coding in a different year to the master list. A planned feature is to allow testing of an ICD-9 code against the valid codes for the year it was entered, but at present only the 2014 master list is used. This means that some older valid codes may no longer be on the list. However, there have been very few changes to ICD-9-CM in the last five years with ICD-10-CM in the wings.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># first ten possible ICD-9 child codes from 391</span>
<span class="fu"><a href="../reference/children.html">children</a></span>(<span class="st">"391"</span>, <span class="kw">defined</span> <span class="kw">=</span> <span class="fl">FALSE</span>)[<span class="fl">1</span>:<span class="fl">10</span>]
<span class="co">#&gt;  [1] "391"   "3910"  "39100" "39101" "39102" "39103" "39104" "39105" "39106"</span>
<span class="co">#&gt; [10] "39107"</span></pre></body></html></div>
<p><code>condense</code> is the reverse operation to <code>children</code>. You need to specify whether you want to consider all possible children or just defined codes.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="kw pkg">icd</span><span class="kw ns">::</span><span class="fu"><a href="../reference/condense.html">condense</a></span>(<span class="fu"><a href="../reference/children.html">children</a></span>(<span class="st">"0032"</span>), <span class="kw">defined</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; [1] "0032"</span>

<span class="no">codes</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/children.html">children</a></span>(<span class="st">"0032"</span>, <span class="kw">defined</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">codes</span>
<span class="co">#&gt;  [1] "0032"  "00320" "00321" "00322" "00323" "00324" "00325" "00326" "00327"</span>
<span class="co">#&gt; [10] "00328" "00329"</span>
<span class="kw pkg">icd</span><span class="kw ns">::</span><span class="fu"><a href="../reference/condense.html">condense</a></span>(<span class="no">codes</span>, <span class="kw">defined</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">#&gt; [1] "0032"</span></pre></body></html></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jack O. Wasey, Michel Lang, R Core Team.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '797795ae271734faa8bc9b1f4aaae82b',
    indexName: 'icd',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
